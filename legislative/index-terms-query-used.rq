SELECT DISTINCT
  ?house ?houseLabel
  ?legislature ?legislatureLabel
  ?term ?termLabel
  ?termStart ?termEnd
  ?termSpecificPosition
WHERE {
  VALUES (?house ?position) {
    (wd:Q2993611 wd:Q19822359)
    (wd:Q665693 wd:Q21290864)
    (wd:Q21043169 wd:Q59528223)
    (wd:Q23038224 wd:Q59528360)
    (wd:Q25053386 wd:Q59528329)
    (wd:Q28406862 wd:Q59528228)
    (wd:Q28450719 wd:Q59528350)
    (wd:Q30592701 wd:Q59528226)
    (wd:Q59518801 wd:Q59528225)
    (wd:Q59518803 wd:Q59528229)
    (wd:Q59518804 wd:Q59528231)
    (wd:Q59518808 wd:Q59528232)
    (wd:Q59518810 wd:Q59528233)
    (wd:Q59518811 wd:Q59528236)
    (wd:Q59518814 wd:Q59528246)
    (wd:Q59518815 wd:Q59528248)
    (wd:Q59518817 wd:Q59528250)
    (wd:Q59518829 wd:Q59528322)
    (wd:Q59518830 wd:Q59528323)
    (wd:Q59518833 wd:Q59528324)
    (wd:Q59518836 wd:Q59528327)
    (wd:Q59518837 wd:Q59528330)
    (wd:Q59518839 wd:Q59528341)
    (wd:Q59518841 wd:Q59528342)
    (wd:Q59518842 wd:Q59528343)
    (wd:Q59518844 wd:Q59528344)
    (wd:Q59518861 wd:Q59528348)
    (wd:Q59518862 wd:Q59528349)
    (wd:Q59518864 wd:Q59528361)
    (wd:Q59518867 wd:Q59528363)
    (wd:Q59518868 wd:Q59528364)
    (wd:Q59518870 wd:Q59528368)
    (wd:Q59518872 wd:Q59528369)
    (wd:Q59518873 wd:Q59528370)
    (wd:Q59518875 wd:Q59528373)
    (wd:Q6364192 wd:Q59528338)
    (wd:Q6472612 wd:Q59528346)
    (wd:Q7338303 wd:Q59528366)
    (wd:Q59523636 wd:Q59528664)
    (wd:Q59523637 wd:Q59528666)
    (wd:Q59523638 wd:Q59528668)
    (wd:Q59523640 wd:Q59528670)
    (wd:Q59523641 wd:Q59528671)
    (wd:Q59523642 wd:Q59528673)
    (wd:Q59523643 wd:Q59528675)
    (wd:Q59523644 wd:Q59528677)
    (wd:Q59523645 wd:Q59528678)
    (wd:Q59523652 wd:Q59528686)
    (wd:Q59523653 wd:Q59528687)
    (wd:Q59523654 wd:Q59528689)
    (wd:Q59523655 wd:Q59528691)
    (wd:Q59523656 wd:Q59528692)
    (wd:Q59523658 wd:Q59528693)
    (wd:Q59523659 wd:Q59528696)
    (wd:Q59523660 wd:Q59528698)
    (wd:Q59523661 wd:Q59528700)
    (wd:Q59523668 wd:Q59528708)
    (wd:Q59523669 wd:Q59528710)
    (wd:Q59523670 wd:Q59528711)
    (wd:Q59523671 wd:Q59528712)
    (wd:Q59523673 wd:Q59528714)
    (wd:Q59523674 wd:Q59528716)
    (wd:Q59523675 wd:Q59528717)
    (wd:Q59523676 wd:Q59528720)
    (wd:Q59523678 wd:Q59528721)
    (wd:Q59523684 wd:Q59528729)
    (wd:Q59523685 wd:Q59528731)
    (wd:Q59523686 wd:Q59528733)
    (wd:Q59523687 wd:Q59528735)
    (wd:Q59523688 wd:Q59528736)
    (wd:Q59523689 wd:Q59528738)
    (wd:Q59523691 wd:Q59528739)
    (wd:Q59523692 wd:Q59528742)
    (wd:Q59523693 wd:Q59528744)
    (wd:Q59523700 wd:Q59528752)
    (wd:Q59523702 wd:Q59528753)
    (wd:Q59523703 wd:Q59528756)
    (wd:Q59523704 wd:Q59528758)
    (wd:Q59523705 wd:Q59528759)
    (wd:Q59523706 wd:Q59528760)
    (wd:Q59523707 wd:Q59528762)
    (wd:Q59523708 wd:Q59528764)
    (wd:Q59523709 wd:Q59528766)
    (wd:Q59523716 wd:Q59528773)
    (wd:Q59523717 wd:Q59528774)
    (wd:Q59523718 wd:Q59528777)
    (wd:Q59523719 wd:Q59528778)
    (wd:Q59523721 wd:Q59528780)
    (wd:Q59523722 wd:Q59528781)
    (wd:Q59523723 wd:Q59528782)
    (wd:Q59523724 wd:Q59528785)
    (wd:Q59523726 wd:Q59528786)
    (wd:Q59523734 wd:Q59528794)
    (wd:Q59523735 wd:Q59528795)
    (wd:Q59523736 wd:Q59528797)
    (wd:Q59523737 wd:Q59528798)
    (wd:Q59523738 wd:Q59528799)
    (wd:Q59523739 wd:Q59528801)
    (wd:Q59523740 wd:Q59528803)
    (wd:Q59523741 wd:Q59528805)
    (wd:Q59523743 wd:Q59528806)
    (wd:Q59523747 wd:Q59528814)
    (wd:Q59523749 wd:Q59528816)
    (wd:Q59523751 wd:Q59528818)
    (wd:Q59523752 wd:Q59528819)
    (wd:Q59523753 wd:Q59528820)
    (wd:Q59523755 wd:Q59528822)
    (wd:Q59523756 wd:Q59528824)
    (wd:Q59523758 wd:Q59528826)
    (wd:Q59523759 wd:Q59528829)
    (wd:Q59523765 wd:Q59528834)
    (wd:Q59523766 wd:Q59528836)
    (wd:Q59523768 wd:Q59528837)
    (wd:Q59523770 wd:Q59528839)
    (wd:Q59523772 wd:Q59528841)
    (wd:Q59523773 wd:Q59528842)
    (wd:Q59523775 wd:Q59528843)
    (wd:Q59523776 wd:Q59528846)
    (wd:Q59523777 wd:Q59528847)
    (wd:Q59523785 wd:Q59528854)
    (wd:Q59523787 wd:Q59528856)
    (wd:Q59523788 wd:Q59528857)
    (wd:Q59523789 wd:Q59528859)
    (wd:Q59523791 wd:Q59528861)
    (wd:Q59523792 wd:Q59528862)
    (wd:Q59523793 wd:Q59528863)
    (wd:Q59523794 wd:Q59528866)
    (wd:Q59523795 wd:Q59528867)
    (wd:Q59523803 wd:Q59528876)
    (wd:Q59523804 wd:Q59528878)
    (wd:Q59523806 wd:Q59528879)
    (wd:Q59523807 wd:Q59528882)
    (wd:Q59523808 wd:Q59528883)
    (wd:Q59523809 wd:Q59528885)
    (wd:Q59523811 wd:Q59528887)
    (wd:Q59523812 wd:Q59528889)
    (wd:Q59523813 wd:Q59528891)
    (wd:Q59523821 wd:Q59528897)
    (wd:Q59523822 wd:Q59528900)
    (wd:Q59523823 wd:Q59528901)
    (wd:Q59523824 wd:Q59528902)
    (wd:Q59523825 wd:Q59528905)
    (wd:Q59523826 wd:Q59528906)
    (wd:Q59523827 wd:Q59528907)
    (wd:Q59523829 wd:Q59528910)
    (wd:Q59523831 wd:Q59528911)
    (wd:Q59523837 wd:Q59528920)
    (wd:Q59523838 wd:Q59528921)
    (wd:Q59523840 wd:Q59528923)
    (wd:Q59523842 wd:Q59528925)
    (wd:Q59523844 wd:Q59528926)
    (wd:Q59523845 wd:Q59528927)
    (wd:Q59523846 wd:Q59528929)
    (wd:Q59523847 wd:Q59528931)
    (wd:Q59523848 wd:Q59528932)
    (wd:Q59523857 wd:Q59528939)
    (wd:Q59523858 wd:Q59528940)
    (wd:Q59523859 wd:Q59528941)
  }
  ?house (p:P361/ps:P361)* ?legislature .
      ?baseTerm p:P31|p:P279 [ ps:P279|ps:P31 wd:Q15238777 ; pq:P642 ?legislature ] .
      OPTIONAL { ?subTerm wdt:P31 ?baseTerm }

  BIND(COALESCE(?subTerm, ?baseTerm) AS ?term)

  OPTIONAL { ?term (wdt:P580|wdt:P571) ?termStart. }
  OPTIONAL { ?term (wdt:P582|wdt:P576) ?termEnd. }
  OPTIONAL { ?term (wdt:P155|wdt:P1365) ?termReplaces }
  OPTIONAL { ?term (wdt:P156|wdt:P1366) ?termReplacedBy }
  OPTIONAL {
    ?termSpecificPosition wdt:P31/wdt:P279* wd:Q4164871 ;
                          p:P279 [ ps:P279 ?position ;
                                   pq:P2937 ?term ] .
  }

  # Only include terms without end dates or whose end dates are in the future
  FILTER (!BOUND(?termEnd) || ?termEnd > NOW())
  # Only include terms which haven't been replaced unless they have end dates
  # (and so by implication, as per above, have end dates in the future)
  FILTER (!BOUND(?termReplacedBy) || BOUND(?termEnd))
  SERVICE wikibase:label { bd:serviceParam wikibase:language "en". }
} ORDER BY ?termStart ?term
